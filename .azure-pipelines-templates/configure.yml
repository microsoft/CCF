jobs:
  - job: configure
    displayName: "Configure CI"
    variables:
      Codeql.SkipTaskAutoInjection: true
      skipComponentGovernanceDetection: true
    pool:
      vmImage: "ubuntu-20.04"
    steps:
      - script: echo "##vso[task.setvariable variable=varA]hello"
        condition: succeededOrFailed()
      - script: |
          echo "##vso[task.setvariable variable=varB]hello"
        condition: succeededOrFailed()
      - script: |
          set -ex
          echo "##vso[task.setvariable variable=varC]hello"
          echo "I've just set varC"
        condition: succeededOrFailed()
      - script: |
          set -ex
          echo '##vso[task.setvariable variable=varD]hello'
          echo "I've just set varD"
        condition: succeededOrFailed()

      - script: |
          echo "varA=$(varA)"
          echo "varB=$(varB)"
          echo "varC=$(varC)"
          echo "varD=$(varD)"
        displayName: Display VSO Vars
        condition: succeededOrFailed()

      - checkout: self
        clean: true

      - script: |
          echo "##vso[task.setvariable variable=docOnly;isOutput=true]true"

        displayName: "Check for runtime changes"
        name: setVarStep
